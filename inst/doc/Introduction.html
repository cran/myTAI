<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="date" content="2015-07-09" />

<title>Introduction to the myTAI Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Introduction to the myTAI Package</h1>
<h4 class="date"><em>2015-07-09</em></h4>
</div>


<div id="performing-phylotranscriptomics-with-r" class="section level2">
<h2>Performing Phylotranscriptomics with R</h2>
<p>The <code>myTAI</code> package allows users to capture evolutionary signals in developmental transcriptomes using a phylotranscriptomic approach.</p>
<p>Phylotranscriptomics defines the concept of combining genetic sequence information with gene expression levels to capture evolutionary signals during development (Domazet-Loso and Tautz, 2010; Quint et al., 2012; Drost et al., 2015).</p>
<p>This subfield of Evolutionary Developmental Biology aims to investigate stages or periods of evolutionary conservation or constraint in developmental processes of extant species.</p>
<p><code>myTAI</code> provides easy to use and optimized functions to perform phylostrancriptomic analyses for any annotated organism and developmental process of interest. Additionally, a customized visualization framework implemented in myTAI allows users to generate publication quality plots of their custom phylotranscriptomic analyses.</p>
<p>The goal of <code>myTAI</code> is to provide a broad range of users interested in the evolution of developmental transcriptomes with an easy to use and computationally optimized framework for reproducible research and modular pipeline implementation.</p>
</div>
<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<p>And intorduction to Phylotranscriptomics as a scientific discipline and its historical context can be found in Drost <em>et al.</em>, 2015.</p>
<p>The following sections provide step by step tutorials on <code>phylotranscriptomic analyses</code>.</p>
<p>As already mentioned above, phylotranscriptomic analyses are based on the combination of genetic sequence information with transcriptome data.</p>
<p>For this purpose the following data sets need to be generated or obtained to be able to perform phylotranscriptomic analyses:</p>
<ul>
<li><p>Phylostratigraphic Map of an Organism (of Interest)</p></li>
<li><p>Divergence Map of an Organism (of Interest)</p></li>
<li><p>Transcriptome Data Covering a Specific Experiment for the Organism (of Interest)</p></li>
</ul>
<p>Each step can be performed independent of all other steps and the resulting data sets can also be used for different (independent) studies and analyses.</p>
<div id="phylostratigraphy-and-divergence-stratigraphy" class="section level3">
<h3>Phylostratigraphy and Divergence Stratigraphy</h3>
<p>The first step in performing phylotranscriptomic analyses is to perform <code>Phylostratigraphy</code> and <code>Divergence Stratigraphy</code> to assign each protein coding genes of an organism of interest an evolutionary age (<a href="http://www.sciencedirect.com/science/article/pii/S0168952507002995">Phylostratigraphy</a>) or degree of selection pressure (<a href="http://mbe.oxfordjournals.org/content/32/5/1221.full">Divergence Stratigraphy</a>). The resulting <code>Phylostratigraphic Map</code> and <code>Divergence Map</code> of the corresponding organism of interest is then matched with a transcriptome data set covering the developmental process of interest.</p>
<p>The following code illustrates how the <code>Phylostratigraphic Map</code> and <code>Divergence Map</code> table format is structured:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(myTAI)

<span class="co"># load example data sets</span>
<span class="kw">data</span>(PhyloExpressionSetExample)
<span class="kw">data</span>(DivergenceExpressionSetExample)

<span class="co"># show an example structure of a Phylostratigraphic Map</span>
<span class="kw">head</span>(PhyloExpressionSetExample[ , <span class="kw">c</span>(<span class="st">&quot;Phylostratum&quot;</span>,<span class="st">&quot;GeneID&quot;</span>)])</code></pre>
<pre><code>  Phylostratum      GeneID
1            1 at1g01040.2
2            1 at1g01050.1
3            1 at1g01070.1
4            1 at1g01080.2
5            1 at1g01090.1
6            1 at1g01120.1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show an example structure of a Divergence Map</span>
<span class="kw">head</span>(DivergenceExpressionSetExample[ , <span class="kw">c</span>(<span class="st">&quot;Divergence.stratum&quot;</span>,<span class="st">&quot;GeneID&quot;</span>)])</code></pre>
<pre><code>  Divergence.stratum      GeneID
1                  1 at1g01050.1
2                  1 at1g01120.1
3                  1 at1g01140.3
4                  1 at1g01170.1
5                  1 at1g01230.1
6                  1 at1g01540.2</code></pre>
<p>Hence, a standard <code>Phylostratigraphic Map</code> or <code>Divergence Map</code> stores the <em>gene age</em> or <em>sequence divergence</em> information in the first column and the corresponding <em>gene id</em> in the second column.</p>
</div>
<div id="performing-phylostratigraphy" class="section level3">
<h3>Performing Phylostratigraphy</h3>
<p>You can find a <code>Perl Script</code> for performing Phylostratigraphy in <a href="https://github.com/HajkD/Active-maintenance-of-phylotranscriptomic-hourglasses/blob/master/README.md">Drost et al., 2015</a>.</p>
<p>Methodologically, the process of performing <code>Phylostratigraphy</code> can be summarized by the following algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Define a toxonomy for the organism of interest.</p></li>
<li><p>Sort all genomes stored in your curated data base (e.g., NCBI nr or any other custom data base) into age categories (= phylostrata) according to the previously defined taxonomy (step 1).</p></li>
<li><p>Perform BLAST homology searches using all protein sequences of the query organism (organism of interest) against a curated data dase.</p></li>
<li><p>Detect the most distant homolog fulfilling the <code>E-value</code> criterium and assign this gene to the phylostratum of the corresponding homolog.</p></li>
<li><p>In case no homolog was found the corresponding gene is labeled as <em>organism specific</em> denoting the youngest phylostratum.</p></li>
</ol>
<div id="step-by-step-instructions-phylostratigraphy" class="section level4">
<h4>Step by Step Instructions: <code>Phylostratigraphy</code></h4>
<p>Here, we will construct an example <code>Phylostratigraphic Map</code> for <em>Arabidopsis thaliana</em>.</p>
<p>In the first step, please go to <a href="https://github.com/HajkD/Active-maintenance-of-phylotranscriptomic-hourglasses/blob/master/createPsMap.pl">Drost et al., 2015</a> and download the <code>Perl Script</code> to run the <code>Phylostratigraphy</code> algorithm. The phyostratigraphic approach is based on taxonomic classification of the organism of interest. The <code>taxonomy()</code> function implemented in <code>myTAI</code> automatically defines a taxonomy for your organism of interest. You can retrieve taxonomic classification information for any annotated species by typing (here we use <em>A. thaliana</em> as example):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># retrieving the taxonomic hierarchy of &quot;Arabidopsis thaliana&quot;</span>
<span class="co"># from NCBI Taxonomy</span>
<span class="kw">taxonomy</span>( <span class="dt">organism =</span> <span class="st">&quot;Arabidopsis thaliana&quot;</span>, 
          <span class="dt">db       =</span> <span class="st">&quot;ncbi&quot;</span>,
          <span class="dt">output   =</span> <span class="st">&quot;classification&quot;</span> )</code></pre>
<pre><code>                   name         rank      id
1    cellular organisms      no rank  131567
2             Eukaryota superkingdom    2759
3         Viridiplantae      kingdom   33090
4          Streptophyta       phylum   35493
5        Streptophytina      no rank  131221
6           Embryophyta      no rank    3193
7          Tracheophyta      no rank   58023
8         Euphyllophyta      no rank   78536
9         Spermatophyta      no rank   58024
10        Magnoliophyta      no rank    3398
11      Mesangiospermae      no rank 1437183
12       eudicotyledons      no rank   71240
13           Gunneridae      no rank   91827
14         Pentapetalae      no rank 1437201
15               rosids     subclass   71275
16              malvids      no rank   91836
17          Brassicales        order    3699
18         Brassicaceae       family    3700
19           Camelineae        tribe  980083
20          Arabidopsis        genus    3701
21 Arabidopsis thaliana      species    3702</code></pre>
<p>The resulting classification table shows all taxonomic categories starting with the <em>oldest</em> taxonomic category (<code>cellular organisms</code>) down to the <em>youngest</em> taxonomic category (<code>Arabidopsis thaliana</code>). The <code>taxonomy ids</code> stored in the third column are used to classify proteomes stored in the curated data base (e.g. NCBI nr) into corresponding taxonomic categories stored in the first column.</p>
<p>In some cases (due to the coverage of sequenced genomes and predicted proteomes) only a very small number of proteomes are classified into a specific taxonomic category. In this case, taxonomic categories can be summarized. For example, Quint et al., 2012 and Drost et al., 2015 summarized the taxonomic categories shown above into 12 categories, so that a minimum amount of proteomes represent a corresponding taxonomic category (see <a href="http://mbe.oxfordjournals.org/content/32/5/1221/F1.expansion.html">Fig. 1 c</a>). These 12 taxonomic categories are represented as 12 <code>phylostrata</code> starting with the <em>oldest</em> <code>phylostratum</code> (= <code>PS1</code> = <code>cellular organisms</code>) up to the <em>youngest</em> <code>phylostratum</code> (= <code>PS12</code> = <code>A. thaliana</code>).</p>
<p>This representation of taxonomic categories as <code>phylostrata</code> are labeled as discrete values <em>1, 2, …, n</em> and are stored in all <code>Phylostratigraphic Maps</code>.</p>
<pre><code>  Phylostratum      GeneID
1            1 at1g01040.2
2            1 at1g01050.1
3            1 at1g01070.1
4            1 at1g01080.2
5            1 at1g01090.1
6            1 at1g01120.1</code></pre>
<p>Here, all genes corresponing to <code>Phylostratum 1</code> (PS1) represent the taxonomic category <code>cellular organisms</code>.</p>
<p>The <code>taxonomy()</code> function allows users to retrieve taxonomic classification information for any annotated organism of interest by specifying its <code>scientific name</code>, e.g. <code>Arabidopsis thaliana</code>, <code>Homo sapiens</code>, <code>Mus musculus</code>, etc. In case you would like to retrieve more information about each functionality and database connection implemented in the <code>taxonomy()</code> function please consult the <a href="Taxonomy.html">Taxonomy</a> Vignette.</p>
<p>The next step is to run the <code>createPsMap.pl</code> script (see also <a href="https://github.com/HajkD/Active-maintenance-of-phylotranscriptomic-hourglasses">Drost et al., 2015</a>).</p>
<p>Now the following steps have to be done to create a <code>Phylostratigraphic Map</code> for <em>A. thaliana</em>:</p>
<ol style="list-style-type: decimal">
<li><p>Make sure that <a href="ftp://ftp.ncbi.nlm.nih.gov/blast/executables/release/2.2.21/">BLAST</a>, <a href="https://www.perl.org/">Perl</a>, and <a href="http://www.bioperl.org/wiki/Installing_BioPerl">BioPerl</a> are installed on your machine.</p></li>
<li><p>Download the sequence database <a href="http://msbi.ipb-halle.de/download/phyloBlastDB_Drost_Gabel_Grosse_Quint.fa.tbz">phyloBlastDB_Drost_Gabel_Grosse_Quint.fa</a> used for BLAST searches and unpack it by opening the Terminal application and typing <code>tar xfvj phyloBlastDB_Drost_Gabel_Grosse_Quint.fa.tbz</code>.</p></li>
<li><p>Make sure that the header of your FASTA-files (e.g. Athaliana_167_protein.fa) fulfills the following specification:<br /> <code>&gt;GeneID | [organism_name] | [taxonomy]</code><br /> Notice, the taxonomy begins after the node “Cellular organisms” e.g.</p></li>
</ol>
<pre><code>&gt;NP_146894.1 | [Aeropyrum pernix] | [Archaea; Crenarchaeota; Thermoprotei; Desulfurococcales; Desulfurococcaceae; Aeropyrum]
or
&gt;YP_001514406.1 | [Acaryochloris marina MBIC11017] | [Bacteria; Cyanobacteria; Oscillatoriophycideae; Chroococcales; Acaryochloris; Acaryochloris marina]
or
&gt;ATCG00500.1|PACid:19637947 | [Arabidopsis thaliana] | [Eukaryota; Viridiplantae; Streptophyta; Streptophytina; Embryophyta; Tracheophyta; Euphyllophyta; Spermatophyta; Magnoliophyta; eudicotyledons; core eudicotyledons; rosids; malvids; Brassicales; Brassicaceae; Camelineae; Arabidopsis]</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><p>Use the following command to start the Perl script</p>
<pre class="terminal"><code>perl createPsMap.pl -i Athaliana_167_protein_with_new_Header.fa -d phyloBlastDB_Drost_Gabel_Grosse_Quint.fa -p BLAST_Athaliana 
                -r athaliana_blast_results -t 30 -a 64             
Arguments:
-i,--input          input file name in FASTA format
-d,--database       BLAST sequence database name
-p,--prefix         Prefix for generated mysql-files containing BLAST results
-r,--resultTable    mysql table name
-t,--threshold      threshold for sequence length (Default 30 amino acids)
-a                  threads for BLAST searches
-e,--evalue         e-value threshold for BLAST </code></pre></li>
</ol>
<p><strong>Note</strong> that <code>Phylostratigraphy</code> needs large computational resources, because of thousands of sequence comparisons between genes of the query organism and thousands of classified proteomes stored in the curated data base. For this task we use a computing cluster with several thousand nodes to be able to solve this task in a few hours to days. Hence, when running the <code>createPsMap.pl</code> script on a laptop or local machine with a small number of computing cores, the task will likely take weeks or months to terminate. Users aiming to adapt the <code>createPsMap.pl</code> to their own computing environment need to be able to parallelize the <code>createPsMap.pl</code> on each node of the computing cluster.</p>
</div>
</div>
<div id="performing-divergence-stratigraphy" class="section level3">
<h3>Performing Divergence Stratigraphy</h3>
<p><a href="http://mbe.oxfordjournals.org/content/32/5/1221.full">Divergence Stratigraphy</a> is a computational method to determine the degree of selection pressure acting on each protein coding gene of a query organism against a reference organism.</p>
<p>A detailed tutorial on how to perform Divergence Stratigraphy for any pairwise genome comparison can be found in the <a href="https://github.com/HajkD/orthologr/blob/master/vignettes/divergence_stratigraphy.Rmd">Divergence Stratigraphy Vignette</a> of the <a href="https://github.com/HajkD/orthologr">orthologr</a> package in which the <code>divergence_stratigraphy()</code> algorithm is implemented.</p>
<p>Following steps summarize the <code>Divergence Stratigraphy</code> algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Orthology Inference using BLAST reciprocal best hit based on the <code>blastp</code> algorithm</p></li>
<li><p>Pairwise global amino acid alignments of orthologous genes using the <a href="http://www.sciencedirect.com/science/article/pii/0022283670900574">Needleman-Wunsch algorithm</a></p></li>
<li><p>Codon alignments of orthologous genes using <a href="http://www.bork.embl.de/pal2nal/">PAL2NAL</a></p></li>
<li><p>dNdS estimation using <a href="http://link.springer.com/article/10.1007/BF00173196">Comeron’s method (1995)</a></p></li>
<li><p>Assigning estimated dNdS values to divergence strata (deciles of all dNdS values)</p></li>
</ol>
<div id="step-by-step-instructions-divergence-stratigraphy" class="section level4">
<h4>Step by Step Instructions: <code>Divergence Stratigraphy</code></h4>
<p>The first step is to install the <a href="https://github.com/HajkD/orthologr">orthologr</a> package on your machine. In the following example we will compute a <code>Divergence Map</code> for <em>A. thaliana</em> versus <em>A. lyrata</em>.</p>
<p>Downloading the CDS files of <code>A. thaliana</code> and <code>A. lyrata</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># download the CDS file of A. thaliana</span>
<span class="kw">download.file</span>( <span class="dt">url      =</span> <span class="st">&quot;ftp://ftp.jgi-psf.org/pub/compgen/phytozome/v9.0/Athaliana/annotation/Athaliana_167_cds.fa.gz&quot;</span>, 
               <span class="dt">destfile =</span> <span class="st">&quot;Athaliana_167_cds.fa.gz&quot;</span> )
               
<span class="co"># download the CDS file of A. lyrata</span>
<span class="kw">download.file</span>( <span class="dt">url      =</span> <span class="st">&quot;ftp://ftp.jgi-psf.org/pub/compgen/phytozome/v9.0/Alyrata/annotation/Alyrata_107_cds.fa.gz&quot;</span>, 
               <span class="dt">destfile =</span> <span class="st">&quot;Alyrata_107_cds.fa.gz&quot;</span> )</code></pre>
<p>Now the files <code>Athaliana_167_cds.fa.gz</code> and <code>Alyrata_107_cds.fa.gz</code> need to be unpacked.</p>
<p>Compute the <code>Divergence Map</code> of <code>A. thaliana</code> versus <code>A. lyrata</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(orthologr)

<span class="co"># compute the divergence map of A. thaliana vs. A. lyrata</span>
Ath_vs_Aly_DM &lt;-<span class="st"> </span><span class="kw">divergence_stratigraphy</span>(
                         <span class="dt">query_file      =</span> <span class="st">&quot;Athaliana_167_cds.fa&quot;</span>,
                         <span class="dt">subject_file    =</span> <span class="st">&quot;Alyrata_107_cds.fa&quot;</span>,
                         <span class="dt">eval            =</span> <span class="st">&quot;1E-5&quot;</span>, 
                         <span class="dt">ortho_detection =</span> <span class="st">&quot;RBH&quot;</span>,
                         <span class="dt">comp_cores      =</span> <span class="dv">1</span>, 
                         <span class="dt">quiet           =</span> <span class="ot">TRUE</span>, 
                         <span class="dt">clean_folders   =</span> <span class="ot">TRUE</span> )
   </code></pre>
<p>In case you are working on a multicore machine, you can specify the <code>comp_cores</code> argument to perform <code>divergence_stratigraphy()</code> using multiple computing cores.</p>
<p>Now the resulting <code>Divergence Map</code> stores the <code>divergence stratum</code> in the first column and the corresponding <code>gene id</code> in the second column.</p>
<pre><code>  Divergence.stratum      GeneID
1                  1 at1g01050.1
2                  1 at1g01120.1
3                  1 at1g01140.3
4                  1 at1g01170.1
5                  1 at1g01230.1
6                  1 at1g01540.2</code></pre>
<p>For a more detailed tutorial on how to use the <code>divergence_stratigraphy()</code> function implemented in <a href="https://github.com/HajkD/orthologr/blob/master/vignettes/divergence_stratigraphy.Rmd">orthologr</a> please consult the <a href="https://github.com/HajkD/orthologr">Divergence Stratigraphy Vignette</a>.</p>
</div>
</div>
</div>
<div id="phyloexpressionset-and-divergenceexpressionset" class="section level2">
<h2><code>PhyloExpressionSet</code> and <code>DivergenceExpressionSet</code></h2>
<p>All functions implemented in the <code>myTAI</code> package expect a specific data format as input data. These standardized data formats are referred to as <strong>PhyloExpressionSet</strong> and <strong>DivergenceExpressionSet</strong>. The following sections will give users an overview about these data formats.</p>
<div id="phyloexpressionset-specifications" class="section level3">
<h3><code>PhyloExpressionSet</code> Specifications</h3>
<p>A <code>PhyloExpressionSet</code> specifies the combination of a <code>Phylostratigraphic Map</code> with an <code>Gene Expression Set</code>. Hence, to generate a <code>PhyloExpressionSet</code> the following two tables need to be joined:</p>
<pre><code># a Phylostratigraphic Map

  Phylostratum      GeneID
1            1 at1g01040.2
2            1 at1g01050.1
3            1 at1g01070.1
4            1 at1g01080.2
5            1 at1g01090.1
6            1 at1g01120.1</code></pre>
<p>and a</p>
<pre><code># gene expression set

       GeneID     Zygote   Quadrant   Globular      Heart    Torpedo       Bent    Mature
1 at1g01040.2  2173.6352  1911.2001  1152.5553  1291.4224  1000.2529   962.9772 1696.4274
2 at1g01050.1  1501.0141  1817.3086  1665.3089  1564.7612  1496.3207  1114.6435 1071.6555
3 at1g01070.1  1212.7927  1233.0023   939.2000   929.6195   864.2180   877.2060  894.8189
4 at1g01080.2  1016.9203   936.3837  1181.3381  1329.4734  1392.6429  1287.9746  861.2605
5 at1g01090.1 11424.5667 16778.1685 34366.6493 39775.6405 56231.5689 66980.3673 7772.5617
6 at1g01120.1   844.0414   787.5929   859.6267   931.6180   942.8453   870.2625  792.7542</code></pre>
<p>In this example the <code>gene expression set</code> covers seven stages of <em>A. thaliana</em> embryo development. This data format is defined as <code>ExpressionMatrix</code> in the <code>myTAI</code> data format specification.</p>
<p>The function <code>MatchMap()</code> allows users to join a <code>Phylostratigraphic Map</code> with an <code>ExpressionMatrix</code> to obtain a <code>PhyloExpressionSet</code>. In some cases, the GeneIDs stored in the <code>ExpressionMatrix</code> and in the <code>Phylostratigraphic Map</code> do not match. This is due to GeneID mappings between different data bases and annotations. To map non matching GeneIDs between data bases and annotations, please consult the <a href="https://github.com/HajkD/biomartr/blob/master/vignettes/Functional_Annotation.Rmd">Functional Annotation Vignette</a> in the <a href="https://github.com/HajkD/biomartr">biomartr</a> package. The <code>biomartr</code> package allows users to map GeneIDs between data base annotations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(myTAI)

<span class="co"># load the example data set</span>
<span class="kw">data</span>(PhyloExpressionSetExample)

<span class="co"># construct an example Phylostratigraphic Map </span>
Example.PhylostratigraphicMap &lt;-<span class="st"> </span>PhyloExpressionSetExample[ , <span class="dv">1</span>:<span class="dv">2</span>]
<span class="co"># construct an example ExpressionMatrix</span>
Example.ExpressionMatrix &lt;-<span class="st"> </span>PhyloExpressionSetExample[ , <span class="dv">2</span>:<span class="dv">9</span>]

<span class="co"># join a PhylostratigraphicMap with an ExpressionMatrix using MatchMap()</span>
Example.PhyloExpressionSet &lt;-<span class="st"> </span><span class="kw">MatchMap</span>(Example.PhylostratigraphicMap, Example.ExpressionMatrix)

<span class="co"># look at a standard PhyloExpressionSet</span>
<span class="kw">head</span>(Example.PhyloExpressionSet, <span class="dv">3</span>)</code></pre>
<pre><code>Phylostratum      GeneID    Zygote  Quadrant  Globular    Heart  Torpedo     Bent   Mature
1            4 at1g01010.1  878.2158  828.2301  776.0703 753.9589 775.3377 756.2460 999.9118
2            2 at1g01020.1 1004.9710 1106.2621 1037.5141 939.0830 961.5249 871.4684 997.5953
3            3 at1g01030.1  819.4880  771.6396  810.8717 866.7780 773.7893 747.9941 785.6105</code></pre>
<p>After matching a <code>Phylostratigraphic Map</code> with an <code>ExpressionMatrix</code> using the <code>MatchMap()</code> function, a standard <code>PhyloExpressionSet</code> is returned storing the Phylostratum assignment of a given gene in the first column, the <em>gene id</em> of the corresponding gene in the second column, and the entire gene expression set (time series or treatments) starting with the third column. This format is crucial for all functions that are implemented in the <code>myTAI</code> package.</p>
<p>Each function implemented in <code>myTAI</code> checks whether or not the PhyloExpressionSet standard is fulfilled.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># used by all myTAI functions to check the validity of the PhyloExpressionSet standard</span>
<span class="kw">is.ExpressionSet</span>(PhyloExpressionSetExample) </code></pre>
<pre><code>[1] TRUE
</code></pre>
<p>In case the PhyloExpressionSet standard is violated, the <code>is.ExpressionSet()</code> function will return <code>FALSE</code> and the corresponding function within the <code>myTAI</code> package will return an error message.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># used a non standard PhyloExpressionSet</span>
<span class="kw">head</span>(PhyloExpressionSetExample[ , <span class="dv">2</span>:<span class="dv">5</span>], <span class="dv">2</span>)</code></pre>
<pre><code>       GeneID   Zygote Quadrant Globular
1 at1g01040.2 2173.635 1911.200 1152.555
2 at1g01050.1 1501.014 1817.309 1665.309
</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.ExpressionSet</span>(PhyloExpressionSetExample[ , <span class="dv">2</span>:<span class="dv">5</span>]) </code></pre>
<pre><code>
Error in is.ExpressionSet(PhyloExpressionSetExample[, 2:5]) : 
  The present input object does not fulfill the ExpressionSet standard.
  </code></pre>
<p>The <code>PhyloExpressionSetExample</code> data set stored within the <code>myTAI</code> package stores the time course (seven stages) of <em>Arabidopsis thaliana</em> embryo development. Again, the first column represents the Phylostratum assignment of a given gene, the second column stores the gene id of the corresponding gene, and columns 3 to 9 store the gene expression set of <em>A. thaliana</em> embryo development.</p>
</div>
<div id="divergenceexpressionset-specifications" class="section level3">
<h3><code>DivergenceExpressionSet</code> Specifications</h3>
<p>A <code>DivergenceExpressionSet</code> specifies the combination of a <code>Divergence Map</code> with an <code>Gene Expression Set</code>. A <code>DivergenceExpressionSet</code> can be generated analogous to a <code>PhyloExpressionSet</code> by joining a <code>Divergence Map</code> with an <code>ExpressionMatrix</code> using the <code>MatchMap()</code> function. In some cases, the GeneIDs stored in the <code>ExpressionMatrix</code> and in the <code>Divergence Map</code> do not match. This is due to GeneID mappings between different data bases and annotations. To map non matching GeneIDs between data bases and annotations, please consult the <a href="https://github.com/HajkD/biomartr/blob/master/vignettes/Functional_Annotation.Rmd">Functional Annotation Vignette</a> in the <a href="https://github.com/HajkD/biomartr">biomartr</a> package.</p>
<p>The following <code>DivergenceExpressionSet</code> example illustrates the standard <code>DivergenceExpressionSet</code> data set format.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># head of an example standard DivergenceExpressionSet</span>
<span class="kw">head</span>(DivergenceExpressionSetExample, <span class="dv">3</span>) </code></pre>
<pre><code>  Divergence.stratum      GeneID    Zygote  Quadrant  Globular    Heart   Torpedo      Bent    Mature
1                  1 at1g01050.1 1501.0141 1817.3086 1665.3089 1564.761 1496.3207 1114.6435 1071.6555
2                  1 at1g01120.1  844.0414  787.5929  859.6267  931.618  942.8453  870.2625  792.7542
3                  1 at1g01140.3 1041.4291  908.3929 1068.8832  967.749 1055.1901 1109.4662  825.4633
</code></pre>
<p>Analogous to a standard <code>PhyloExpressionSet</code>, a standard <code>DivergenceExpressionSet</code> is a <code>data.frame</code> storing the Divergence Stratum assignment of a given gene in the first column, the gene id of the corresponding gene in the second column, and the entire gene expression set (time series or treatments) starting with the third column.</p>
<p><strong>The PhyloExpressionSet and DivergenceExpressioNSet formats are crucial for all functions that are implemented in the <code>myTAI</code> package</strong>.</p>
<p>Keeping these standard data formats in mind will provide you with the most important requirements to get started with the <code>myTAI</code> package.</p>
<p><strong>Note</strong>, that within the code of each function, the argument <code>ExpressionSet</code> always refers to either a PhyloExpressionSet or a DivergenceExpressionSet, whereas in specialized functions some arguments are specified as <em>PhyloExpressionSet</em> when they take an PhyloExpressionSet as input data set, or specified as <em>DivergenceExpressionSet</em> when they take an <em>DivergenceExpressionSet</em> as input data set.</p>
</div>
</div>
<div id="skip-phylostratigraphy-and-divergence-stratigraphy-and-download-already-published-phyloexpressionsets-or-divergenceexpressionsets" class="section level2">
<h2>Skip <code>Phylostratigraphy</code> and <code>Divergence Stratigraphy</code> and Download Already Published <code>PhyloExpressionSets</code> or <code>DivergenceExpressionSets</code></h2>
<p>The <code>myTAI</code> package also provides the statistical framework for existing PhyloExpressionSets or DivergenceExpressionSets. To re-analyze, reproduce, or further investigate phenomena of existing PhyloExpressionSets or DivergenceExpressionSets, you can use the following procedure to download published datasets. In this example we will download <code>Supplementary Table S3</code> from Drost et al., 2015.</p>
<p>Users can find a detailed list of <a href="https://github.com/HajkD/published_phylomaps">published Phylostratigraphic Maps and Divergence Maps</a> by following the link.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install the readxl package</span>
<span class="kw">install.packages</span>(<span class="st">&quot;readxl&quot;</span>)

<span class="co"># load package readxl</span>
<span class="kw">library</span>(readxl)

url_phyloSet &lt;-<span class="st"> &quot;http://files.figshare.com/1798296/Supplementary_table_S3.xls&quot;</span>

<span class="kw">download.file</span>( <span class="dt">url      =</span>  url_phyloSet,
               <span class="dt">destfile =</span> <span class="st">&quot;PhyloExpressionSetTables.xls&quot;</span> )

Athaliana_PhyloExpressionSet &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;PhyloExpressionSetTables.xls&quot;</span>, <span class="dt">sheet =</span> <span class="dv">3</span>)

<span class="kw">head</span>(Athaliana_PhyloExpressionSet)</code></pre>
<pre><code>  Phylostratum      GeneID     Zygote   Quadrant   Globular      Heart    Torpedo       Bent    Mature
1            1 at1g01040.2  2173.6352  1911.2001  1152.5553  1291.4224  1000.2529   962.9772 1696.4274
2            1 at1g01050.1  1501.0141  1817.3086  1665.3089  1564.7612  1496.3207  1114.6435 1071.6555
3            1 at1g01070.1  1212.7927  1233.0023   939.2000   929.6195   864.2180   877.2060  894.8189
4            1 at1g01080.2  1016.9203   936.3837  1181.3381  1329.4734  1392.6429  1287.9746  861.2605
5            1 at1g01090.1 11424.5667 16778.1685 34366.6493 39775.6405 56231.5689 66980.3673 7772.5617
6            1 at1g01120.1   844.0414   787.5929   859.6267   931.6180   942.8453   870.2625  792.7542</code></pre>
<p>This way you can download all published PhyloExpressionSets or DivergenceExpressionSets to perform phylotranscriptomics analyses.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute the Transcriptome Age Index of the downloaded PhyloExpressionSet</span>
<span class="kw">TAI</span>(Athaliana_PhyloExpressionSet)</code></pre>
<pre><code>  Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature 
3.229942 3.225614 3.107135 3.116693 3.073993 3.176511 3.390334 </code></pre>
<p>Users can also use <a href="https://github.com/HajkD/published_phylomaps">published Phylostratigraphic Maps and Divergence Maps</a> and match them with their own transcriptome data of interest using the <code>MatchMap()</code> function. This procedure allows users to generate custom <code>PhyloExpressionSet</code> and <code>DivergenceExpressionSet</code> to perform phylotranscriptomic analyses with <code>myTAI</code>.</p>
</div>
<div id="performing-a-standard-workflow-for-phylotranscriptomics-analyses" class="section level2">
<h2>Performing a Standard Workflow for Phylotranscriptomics Analyses</h2>
<p>Before starting any computation, sometimes it is good to visualize the Phylostratum distribution of genes stored within a given PhyloExpressionSet.</p>
<p>For this purpose, the <code>PlotDistribution()</code> function was implemented:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Display the phylostratum distribution (gene frequency distribution) </span>
<span class="co"># of a PhyloExpressionSet as absolute frequency distribution</span>
<span class="kw">PlotDistribution</span>( <span class="dt">PhyloExpressionSet =</span> PhyloExpressionSetExample, 
                  <span class="dt">xlab               =</span> <span class="st">&quot;Phylostratum&quot;</span> )</code></pre>
<p>or display it as relative frequencies:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot phylostrata as relative frequency distribution</span>
<span class="kw">PlotDistribution</span>( <span class="dt">PhyloExpressionSet =</span> PhyloExpressionSetExample, 
                  <span class="dt">as.ratio           =</span> <span class="ot">TRUE</span>, 
                  <span class="dt">xlab               =</span> <span class="st">&quot;Phylostratum&quot;</span>, 
                  <span class="dt">cex                =</span> <span class="fl">0.7</span> )</code></pre>
<p>Another important feature to check is whether the Phylostratum assignment and Divergence-Stratum assignment of the genes stored within the PhyloExpressionSet and DivergenceExpressionSet are correlated (linear dependent). This is important to be able to assume the linear independence of <strong>TAI</strong> and <strong>TDI</strong> measures. This step is useful, because the TAI and TDI measures aim to quantify different signals of evolutionary conservation. Whereas the TAI measure aims to quantify evolutionary signals based on gene origin along the tree of life, the TDI measure is based on quantifying the selection pressure acting on orthologous genes between closely related species.</p>
<p>For this purpose the <code>PlotCorrelation()</code> function was implemented:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the correlation between Phylostratum and Divergence-Stratum assignments</span>
<span class="co"># of the intersecting set of genes that are stored within the PhyloExpressionSet</span>
<span class="co"># and DivergenceExpressionSet</span>

<span class="kw">PlotCorrelation</span>( <span class="dt">PhyloExpressionSet      =</span> PhyloExpressionSetExample,
                 <span class="dt">DivergenceExpressionSet =</span> DivergenceExpressionSetExample,
                 <span class="dt">method                  =</span> <span class="st">&quot;kendall&quot;</span>, 
                 <span class="dt">linearModel             =</span> <span class="ot">TRUE</span> )</code></pre>
<p>In this case Phylostratum and Divergence-Stratum assignments of the intersecting set of genes that are stored within the PhyloExpressionSet and DivergenceExpressionSet are weakly correlated, but can be assumed to be linear independent.</p>
<p><strong>Note</strong>: The <code>PlotCorrelation()</code> function always takes a PhyloExpressionSet as <strong>first argument</strong> and a DivergenceExpressionSet as <strong>second argument</strong>.</p>
<div id="visualizing-the-transcriptome-age-index-and-the-transcriptome-divergence-index" class="section level3">
<h3>Visualizing the <em>Transcriptome Age Index</em> and the <em>Transcriptome Divergence Index</em></h3>
<p>Mathematically the <em>Transcriptome Age Index</em> (TAI) introduced by Domazet-Loso and Tautz, 2010 represents a weighted arithmetic mean of the transcriptome age during a corresponding developmental stage <em>s</em>.</p>
<p><span class="math">\(TAI_s = \sum_{i = 1}^n \frac{ps_i * e_{is}}{\sum_{i = 1}^n e_{is}}\)</span></p>
<p>where <span class="math">\(ps_i\)</span> denotes the phylostratum assignment of gene <span class="math">\(i\)</span> and <span class="math">\(e_{is}\)</span> denotes the gene expression level of gene <span class="math">\(i\)</span> at developmental time point <span class="math">\(s\)</span>. A lower value of TAI describes an older transcriptome age, whereas a higher value of TAI denotes a younger transcriptome age.</p>
<p>Analogous to the TAI measure, the <em>Transcriptome Divergence Index</em> (TDI) was introduced by Quint et al., 2012 and Drost et al., 2015 as weighted arithmetic mean of the degree of sequence divergence of the transcriptome being expressed during a corresponding developmental stage <span class="math">\(s\)</span>.</p>
<p><span class="math">\(TDI_s = \sum_{i = 1}^n \frac{ds_i * e_{is}}{\sum_{i = 1}^n e_{is}}\)</span></p>
<p>where <span class="math">\(ds_i\)</span> denotes the divergence stratum assignment of gene <span class="math">\(i\)</span> and <span class="math">\(e_{is}\)</span> denotes the gene expression level of gene <span class="math">\(i\)</span> at developmental time point <span class="math">\(s\)</span>. A lower value of TDI describes an more conserved transcriptome (in terms of sequence dissimilarity), whereas a higher value of TDI denotes a more variable transcriptome.</p>
</div>
</div>
<div id="transcriptome-age-index-analyses" class="section level2">
<h2>Transcriptome Age Index Analyses</h2>
<p><a href="http://mbe.oxfordjournals.org/content/32/5/1221.full">Drost et al., 2015</a> introduced three statistical tests to quantify the significance of observed TAI patterns: <code>Flat Line Test</code>, <code>Reductive Hourglass Test</code>, and <code>Reductive Early Conservation Test</code>.</p>
<div id="flat-line-test" class="section level3">
<h3>Flat Line Test</h3>
<p>The <code>PlotPattern()</code> function first computes the <code>TAI</code> (given a PhyloExpressionSet) or the <code>TDI</code> (given a DivergenceExpressionSet) to visualize the TAI or TDI profile, their standard deviation, and statistical significance.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the Transcriptome Age Index of a given PhyloExpressionSet </span>
<span class="co"># Test Statistic : Flat Line Test (default)</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span> )</code></pre>
<p>The p-value (<code>p_flt</code>) above the TAI curve is returned by the <code>FlatLineTest</code>. As described in the documentation of <code>PlotPattern()</code> (<code>?PlotPattern</code> or <code>?FlatLineTest</code>), the <code>FlatLineTest</code> is the default statistical test to quantify the statistical significance of the observed phylotranscriptomic pattern. In detail, the test quantifies any statistically significant deviation of the phylotranscriptomic pattern from a flat line. Here, we define any significant deviation of a phylotranscriptomic pattern from a flat line as evolutionary signal. Furthermore, we define corresponding stages of deviation as evolutionary conserved or variable (less conserved) depending on the magnitude of <code>TAI</code> and corresponding p-values.</p>
</div>
<div id="reductive-hourglass-test" class="section level3">
<h3>Reductive Hourglass Test</h3>
<p>In case the observed phylotranscriptomic pattern not only significantly deviates from a flat line but also visually resembles an <em>hourglass</em> shape, one can obtain a p-value quantifying the statistical significance of a visual <em>hourglass</em> pattern based on the <code>ReductiveHourglassTest</code> (<code>?ReductiveHourglassTest</code>).</p>
<p>Since the <code>ReductiveHourglassTest</code> has been defined for a priori biological knowledge <a href="http://mbe.oxfordjournals.org/content/32/5/1221.short?rss=1">Drost et al., 2015</a>, the <code>modules</code> argument within the <code>ReductiveHourglassTest()</code> function needs to be specified.</p>
<p>Three modules need to be specified: an <strong>early-module</strong>, <strong>phylotypic module</strong> (mid), and a <strong>late-module</strong>.</p>
<p>For this example we divide <em>A. thaliana</em> embryo development stored within the <em>PhyloExpressionSetExample</em> into the following three modules:</p>
<ul>
<li>early = stages 1 - 2 (Zygote and Quadrant)</li>
<li>mid = stages 3 - 5 (Globular, Heart, and Torpedo)</li>
<li>late = stages 6 - 7 (Bent and Mature)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the Transcriptome Age Index of a given PhyloExpressionSet </span>
<span class="co"># Test Statistic : Reductive Hourglass Test</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">TestStatistic =</span> <span class="st">&quot;ReductiveHourglassTest&quot;</span>,
             <span class="dt">modules       =</span> <span class="kw">list</span>(<span class="dt">early =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">mid =</span> <span class="dv">3</span>:<span class="dv">5</span>, <span class="dt">late =</span> <span class="dv">6</span>:<span class="dv">7</span>),
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span> )</code></pre>
<p>The corresponding p-value <code>p_rht</code> now denotes the p-value returned by the <code>ReductiveHourglassTest</code> which is different from the p-value returned by the <code>FlatLineTest</code> (<code>p_flt</code>).</p>
<p>To make sure that correct modules have been selected to perform the <code>ReductiveHourglassTest</code>, you can use the <code>shaded.area</code> argument to visualize chosen modules:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize the phylotypic period used for the Reductive Hourglass Test</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">TestStatistic =</span> <span class="st">&quot;ReductiveHourglassTest&quot;</span>,
             <span class="dt">modules       =</span> <span class="kw">list</span>(<span class="dt">early =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">mid =</span> <span class="dv">3</span>:<span class="dv">5</span>, <span class="dt">late =</span> <span class="dv">6</span>:<span class="dv">7</span>),
             <span class="dt">shaded.area   =</span> <span class="ot">TRUE</span>, 
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span> )</code></pre>
<p><strong>Note</strong> that for defining a priori knowledge for the <code>ReductiveHourglassTest</code> using the <code>modules</code> argument, modules need to start at stage 1, …, N and do not correspond to the column position in the <em>PhyloExpressionSet/DivergenceExpressionSet</em> which in contrast would start at position 3, … N + 2.</p>
</div>
<div id="reductive-early-conservation-test" class="section level3">
<h3>Reductive Early Conservation Test</h3>
<p>The third test statistic that is implemented in the <code>myTAI</code> package is the <code>EarlyConservationTest</code>.</p>
<p>The <code>EarlyConservationTest</code> tests whether an observed phylotranscriptomic pattern follows a low-high-high pattern (monotonically increasing function) supporting the Early Conservation Model of embryogenesis.</p>
<p>Analogous to the <code>ReductiveHourglassTest</code>, the <code>EarlyConservationTest</code> needs a priori biological knowledge <a href="http://mbe.oxfordjournals.org/content/32/5/1221.short?rss=1">Drost et al., 2015</a>. So again three <code>modules</code> have to be specified for the <code>EarlyConservationTest()</code> function.</p>
<p>Three modules need to be specified: an <strong>early-module</strong>, <strong>phylotypic module</strong> (mid), and a <strong>late-module</strong>.</p>
<p>For this example we divide <em>A. thaliana</em> embryo development stored within the <em>PhyloExpressionSetExample</em> into the following three modules:</p>
<ul>
<li>early = stages 1 - 2 (Zygote and Quadrant)</li>
<li>mid = stages 3 - 5 (Globular, Heart, and Torpedo)</li>
<li>late = stages 6 - 7 (Bent and Mature)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the Transcriptome Age Index of a given PhyloExpressionSet </span>
<span class="co"># Test Statistic : Reductive Early Conservation Test</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">TestStatistic =</span> <span class="st">&quot;EarlyConservationTest&quot;</span>,
             <span class="dt">modules       =</span> <span class="kw">list</span>(<span class="dt">early =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">mid =</span> <span class="dv">3</span>:<span class="dv">5</span>, <span class="dt">late =</span> <span class="dv">6</span>:<span class="dv">7</span>),
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span> )</code></pre>
<p>The corresponding p-value <code>p_ect</code> now denotes the p-value returned by the <code>EarlyConservationTest</code> which is different from the p-value returned by the <code>FlatLineTest</code> (<code>p_flt</code>) and <code>ReductiveHourglassTest</code> (<code>p_rht</code>).</p>
<p>Since the present TAI pattern of the <em>PhyloExpressionSetExample</em> doesn’t support the Early Conservation Hypothesis, the p-value <code>p_ect</code> = 1.</p>
<p>Again <strong>note</strong> that for defining a priori knowledge for the <code>EarlyConservationTest</code> using the <code>modules</code> argument, modules need to start at stage 1, …, N and do not correspond to the column position in the <em>PhyloExpressionSet/DivergenceExpressionSet</em> which in contrast would start at position 3, … N + 2.</p>
<p>To obtain the numerical <em>TAI</em> values, the <code>TAI()</code> function can be used:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute the Transcriptome Age Index values of a given PhyloExpressionSet</span>
<span class="kw">TAI</span>(PhyloExpressionSetExample) </code></pre>
<pre><code>  Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature 
3.229942 3.225614 3.107135 3.116693 3.073993 3.176511 3.390334 
</code></pre>
</div>
</div>
<div id="transcriptome-divergence-index-analyses" class="section level2">
<h2>Transcriptome Divergence Index Analyses</h2>
<p>Analogous to the <em>TAI</em> computations and visualization, the <em>TDI</em> computations can be performed in a similar fashion:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the Transcriptome Divergence Index of a given DivergenceExpressionSet </span>
<span class="co"># Test Statistic : Flat Line Test (default)</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> DivergenceExpressionSetExample, 
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>,
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TDI&quot;</span> )</code></pre>
<p>Again, for the <strong>ReductiveHourglassTest</strong> we divide <em>A. thaliana</em> embryo development into three modules:</p>
<ul>
<li>early = stages 1 - 2 (Zygote and Quadrant)</li>
<li>mid = stages 3 - 5 (Globular, Heart, and Torpedo)</li>
<li>late = stages 6 - 7 (Bent and Mature)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the Transcriptome Divergence Index of a given DivergenceExpressionSet </span>
<span class="co"># Test Statistic : Reductive Hourglass Test</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> DivergenceExpressionSetExample, 
             <span class="dt">TestStatistic =</span> <span class="st">&quot;ReductiveHourglassTest&quot;</span>,
             <span class="dt">modules       =</span> <span class="kw">list</span>(<span class="dt">early =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">mid =</span> <span class="dv">3</span>:<span class="dv">5</span>, <span class="dt">late =</span> <span class="dv">6</span>:<span class="dv">7</span>),
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TDI&quot;</span> )</code></pre>
<p>And for the <strong>EarlyConservationTest</strong> we again divide <em>A. thaliana</em> embryo development into three modules:</p>
<ul>
<li>early = stages 1 - 2 (Zygote and Quadrant)</li>
<li>mid = stages 3 - 5 (Globular, Heart, and Torpedo)</li>
<li>late = stages 6 - 7 (Bent and Mature)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the Transcriptome Divergence Index of a given DivergenceExpressionSet </span>
<span class="co"># Test Statistic : Reductive Early Conservation Test</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> DivergenceExpressionSetExample, 
             <span class="dt">TestStatistic =</span> <span class="st">&quot;EarlyConservationTest&quot;</span>,
             <span class="dt">modules       =</span> <span class="kw">list</span>(<span class="dt">early =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">mid =</span> <span class="dv">3</span>:<span class="dv">5</span>, <span class="dt">late =</span> <span class="dv">6</span>:<span class="dv">7</span>),
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TDI&quot;</span> )</code></pre>
<p>To obtain the numerical TDI values for a given DivergenceExpressionSet simply run:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute the Transcriptome Divergence Index values of a given DivergenceExpressionSet</span>
<span class="kw">TDI</span>(DivergenceExpressionSetExample) </code></pre>
<pre><code>  Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature 
4.532029 4.563200 4.485705 4.500868 4.466477 4.530704 4.690292
</code></pre>
<div id="phylostratum-or-divergence-stratum-specific-contribution-to-the-global-transcriptome-index-profile" class="section level3">
<h3><code>Phylostratum</code> or <code>Divergence Stratum</code> specific contribution to the global transcriptome index profile</h3>
<p>Another way to visualize the cumulative contribution of each <code>Phylostratum</code> or <code>Divergence Stratum</code> to the global Transcriptome Age Index or Transcriptome Divergence Index profile was introduced by Domazet-Loso and Tautz, 2010 (Fig. 1b). The advantage of visualizing the cumulative contribution of each <code>Phylostratum</code> or <code>Divergence Stratum</code> to the global pattern is to study how the final (global) TAI or TDI profile emerges from the cumulative distribution of each <code>Phylostratum</code> or <code>Divergence Stratum</code>. This <code>Phylostratum</code> or <code>Divergence Stratum</code> specific contribution on the global TAI or TDI pattern can be visualized using <code>PlotContribution()</code>:</p>
<div id="example-phylostrata" class="section level4">
<h4>Example: <code>Phylostrata</code></h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize phylostrata contribution to the global TAI pattern</span>
 <span class="kw">PlotContribution</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample,
                   <span class="dt">legendName    =</span> <span class="st">&quot;PS&quot;</span>,
                   <span class="dt">lwd           =</span> <span class="dv">6</span>,
                   <span class="dt">cex           =</span> <span class="fl">0.5</span>)</code></pre>
<p>The exact values of the <code>Phylostratum</code> specific cumulative TAI profiles can be obtained using the <code>pTAI()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pTAI</span>(PhyloExpressionSetExample)</code></pre>
<pre><code>      Zygote  Quadrant  Globular     Heart   Torpedo      Bent    Mature
1  0.3929533 0.3935308 0.4142106 0.4115399 0.4216806 0.4178302 0.3883815
2  0.9521021 0.9547833 0.9748522 0.9674842 0.9632213 0.9285336 0.8661883
3  1.0502814 1.0477016 1.0576104 1.0556300 1.0549156 1.0187303 0.9722031
4  1.3861830 1.3810595 1.3837548 1.3928030 1.3876006 1.3632945 1.3656170
5  1.5527473 1.5489829 1.5360986 1.5500708 1.5468767 1.5531699 1.5769758
6  1.8114772 1.8171167 1.7806803 1.7968463 1.8020203 1.8223456 1.9207232
7  1.8766090 1.8739449 1.8317327 1.8530276 1.8573216 1.8776292 1.9952325
8  1.9417254 1.9357499 1.8877436 1.9089144 1.9117438 1.9478303 2.0778287
9  2.0339192 2.0294517 1.9823091 1.9982678 1.9915249 2.0413791 2.1878074
10 2.4215868 2.4361137 2.3489524 2.3347670 2.3028346 2.3797112 2.5142773
11 2.4900201 2.5079107 2.4104647 2.3980760 2.3651571 2.4422093 2.5961316
12 3.2299418 3.2256139 3.1071348 3.1166934 3.0739935 3.1765113 3.3903336</code></pre>
</div>
<div id="example-divergence-strata" class="section level4">
<h4>Example: <code>Divergence Strata</code></h4>
<p>Analogously, the <code>Divergence Stratum</code> specific influence on the global TDI pattern can be visualized using:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize divergence stratum contribution to global TDI</span>
 <span class="kw">PlotContribution</span>( <span class="dt">ExpressionSet =</span> DivergenceExpressionSetExample,
                   <span class="dt">legendName    =</span> <span class="st">&quot;DS&quot;</span>,
                   <span class="dt">lwd           =</span> <span class="dv">6</span>,
                   <span class="dt">cex           =</span> <span class="fl">0.5</span>)</code></pre>
<p>The exact values of the <code>Divergence Stratum</code> specific cumulative TDI values can be obtained using the <code>pTDI()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pTDI</span>(DivergenceExpressionSetExample)</code></pre>
<pre><code>      Zygote  Quadrant  Globular     Heart   Torpedo      Bent    Mature
1  0.2174378 0.2207644 0.2309211 0.2214881 0.2195601 0.2047938 0.1704023
2  0.4800055 0.4762352 0.4821244 0.4752145 0.4799418 0.4695871 0.4288670
3  0.7742988 0.7597816 0.7797646 0.7826244 0.8033702 0.8034316 0.7769026
4  1.1463780 1.1285545 1.1408903 1.1528497 1.1694967 1.1784113 1.1933157
5  1.5652686 1.5489672 1.5545589 1.5698173 1.5934158 1.6003011 1.6330444
6  2.0899161 2.0609661 2.0666314 2.1015199 2.1163138 2.1306059 2.1932280
7  2.6262330 2.6035894 2.6012719 2.6453427 2.6477490 2.6664143 2.8085434
8  3.2211299 3.1990804 3.1767694 3.2319604 3.2292835 3.2693046 3.4412353
9  3.8396769 3.8299654 3.7793476 3.8353941 3.8272391 3.8971210 4.0753877
10 4.5320286 4.5632002 4.4857052 4.5008685 4.4664774 4.5307040 4.6902921</code></pre>
<p>In both cases (<code>Phylostrata</code> and <code>Divergence Strata</code>) the <code>pTAI()</code> and <code>pTDI()</code> functions return a numeric matrix storing the cumulative TAI or TDI values for each <code>Phylostratum</code> and <code>Divergence Stratum</code>. Note, that the TAI values of <code>Phylostratum</code> 12 (in the <code>pTAI()</code> matrix) are equivalent to <code>TAI(PhyloExpressionSetExample)</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show that the cumulative TAI value of PS 12 is</span>
<span class="co"># equavalent to the global TAI() values</span>
<span class="kw">pTAI</span>(PhyloExpressionSetExample)[<span class="dv">12</span> , ]

<span class="co"># &gt;  Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature </span>
<span class="co"># &gt; 3.229942 3.225614 3.107135 3.116693 3.073993 3.176511 3.390334 </span>

<span class="kw">TAI</span>(PhyloExpressionSetExample)

<span class="co"># &gt;  Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature </span>
<span class="co"># &gt; 3.229942 3.225614 3.107135 3.116693 3.073993 3.176511 3.390334</span></code></pre>
<p>This can be explained by the definition of the TAI. Here the sum of all partial TAI values over all <code>Phylostrata</code> is equals the global TAI values:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show that the colSum() of partial TAI values</span>
<span class="co"># over all Phylostrata equals the global TAI() values</span>
<span class="kw">apply</span>(<span class="kw">pStrata</span>(PhyloExpressionSetExample) , <span class="dv">2</span> , sum)

<span class="co"># &gt;  Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature </span>
<span class="co"># &gt; 3.229942 3.225614 3.107135 3.116693 3.073993 3.176511 3.390334</span></code></pre>
<p>Now, the <code>PlotContribution()</code> only differs from <code>apply(pStrata(PhyloExpressionSetExample) , 2 , sum)</code> by exchanging the <code>sum()</code> by <code>cumsum()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show that apply(pStrata(PhyloExpressionSetExample) , 2 , cumsum)</span>
<span class="co"># is equivalent to pTAI()</span>
<span class="kw">apply</span>(<span class="kw">pStrata</span>(PhyloExpressionSetExample) , <span class="dv">2</span> , cumsum)</code></pre>
<pre><code>      Zygote  Quadrant  Globular     Heart   Torpedo      Bent    Mature
1  0.3929533 0.3935308 0.4142106 0.4115399 0.4216806 0.4178302 0.3883815
2  0.9521021 0.9547833 0.9748522 0.9674842 0.9632213 0.9285336 0.8661883
3  1.0502814 1.0477016 1.0576104 1.0556300 1.0549156 1.0187303 0.9722031
4  1.3861830 1.3810595 1.3837548 1.3928030 1.3876006 1.3632945 1.3656170
5  1.5527473 1.5489829 1.5360986 1.5500708 1.5468767 1.5531699 1.5769758
6  1.8114772 1.8171167 1.7806803 1.7968463 1.8020203 1.8223456 1.9207232
7  1.8766090 1.8739449 1.8317327 1.8530276 1.8573216 1.8776292 1.9952325
8  1.9417254 1.9357499 1.8877436 1.9089144 1.9117438 1.9478303 2.0778287
9  2.0339192 2.0294517 1.9823091 1.9982678 1.9915249 2.0413791 2.1878074
10 2.4215868 2.4361137 2.3489524 2.3347670 2.3028346 2.3797112 2.5142773
11 2.4900201 2.5079107 2.4104647 2.3980760 2.3651571 2.4422093 2.5961316
12 3.2299418 3.2256139 3.1071348 3.1166934 3.0739935 3.1765113 3.3903336</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pTAI</span>(PhyloExpressionSetExample)</code></pre>
<pre><code>      Zygote  Quadrant  Globular     Heart   Torpedo      Bent    Mature
1  0.3929533 0.3935308 0.4142106 0.4115399 0.4216806 0.4178302 0.3883815
2  0.9521021 0.9547833 0.9748522 0.9674842 0.9632213 0.9285336 0.8661883
3  1.0502814 1.0477016 1.0576104 1.0556300 1.0549156 1.0187303 0.9722031
4  1.3861830 1.3810595 1.3837548 1.3928030 1.3876006 1.3632945 1.3656170
5  1.5527473 1.5489829 1.5360986 1.5500708 1.5468767 1.5531699 1.5769758
6  1.8114772 1.8171167 1.7806803 1.7968463 1.8020203 1.8223456 1.9207232
7  1.8766090 1.8739449 1.8317327 1.8530276 1.8573216 1.8776292 1.9952325
8  1.9417254 1.9357499 1.8877436 1.9089144 1.9117438 1.9478303 2.0778287
9  2.0339192 2.0294517 1.9823091 1.9982678 1.9915249 2.0413791 2.1878074
10 2.4215868 2.4361137 2.3489524 2.3347670 2.3028346 2.3797112 2.5142773
11 2.4900201 2.5079107 2.4104647 2.3980760 2.3651571 2.4422093 2.5961316
12 3.2299418 3.2256139 3.1071348 3.1166934 3.0739935 3.1765113 3.3903336</code></pre>
<p>This <code>pTAI()</code> matrix is what is being visualized inside <code>PlotContribution()</code>.</p>
<p><strong>Note</strong> that the <code>pStrata()</code> function returns the partial TAI or TDI values for each <code>Phylostratum</code> or <code>Divergence Stratum</code>, whereas <code>pMatrix()</code> returns the partial TAI or TDI value for each gene.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compute partial TAI values for each Phylostratum</span>
<span class="kw">pStrata</span>(PhyloExpressionSetExample)</code></pre>
<pre><code>       Zygote   Quadrant   Globular      Heart    Torpedo       Bent     Mature
1  0.39295331 0.39353082 0.41421061 0.41153988 0.42168061 0.41783018 0.38838151
2  0.55914875 0.56125250 0.56064163 0.55594427 0.54154068 0.51070341 0.47780681
3  0.09817938 0.09291830 0.08275821 0.08814585 0.09169432 0.09019669 0.10601483
4  0.33590159 0.33335787 0.32614435 0.33717297 0.33268496 0.34456426 0.39341385
5  0.16656429 0.16792339 0.15234382 0.15726786 0.15927610 0.18987539 0.21135880
6  0.25872990 0.26813378 0.24458170 0.24677547 0.25514358 0.26917571 0.34374736
7  0.06513175 0.05682826 0.05105236 0.05618130 0.05530130 0.05528356 0.07450933
8  0.06511643 0.06180498 0.05601089 0.05588683 0.05442226 0.07020109 0.08259620
9  0.09219381 0.09370185 0.09456557 0.08935340 0.07978112 0.09354879 0.10997873
10 0.38766762 0.40666192 0.36664326 0.33649918 0.31130963 0.33833215 0.32646984
11 0.06843326 0.07179705 0.06151227 0.06330899 0.06232254 0.06249801 0.08185437
12 0.73992167 0.71770319 0.69667019 0.71861745 0.70883635 0.73430205 0.79420194</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compute partial TAI values for each gene</span>
dplyr::<span class="kw">glimpse</span>(<span class="kw">pMatrix</span>(PhyloExpressionSetExample))</code></pre>
<pre><code>Observations: 25260
Variables:
$ Zygote   (dbl) 3.597950e-05, 2.484581e-05, 2.007498e-05, 1.683276e-05, 1.891073e-...
$ Quadrant (dbl) 3.203218e-05, 3.045853e-05, 2.066542e-05, 1.569402e-05, 2.812062e-...
$ Globular (dbl) 2.013329e-05, 2.909027e-05, 1.640631e-05, 2.063608e-05, 6.003300e-...
$ Heart    (dbl) 2.311604e-05, 2.800871e-05, 1.663988e-05, 2.379714e-05, 7.119708e-...
$ Torpedo  (dbl) 1.813626e-05, 2.713080e-05, 1.566972e-05, 2.525094e-05, 1.019572e-...
$ Bent     (dbl) 1.685284e-05, 1.950712e-05, 1.535178e-05, 2.254055e-05, 1.172208e-...
$ Mature   (dbl) 2.684331e-05, 1.695727e-05, 1.415911e-05, 1.362810e-05, 1.229886e-...</code></pre>
<p>You can receive all gene specific partial TAI values by typing <code>pMatrix(PhyloExpressionSetExample)</code>.</p>
<p>Analogously, <code>pStrata()</code> and <code>pMatrix()</code> can be used for <code>Divergence Strata</code> by substituting <code>PhyloExpressionSetExample</code> by <code>DivergenceExpressionSetExample</code>.</p>
</div>
</div>
<div id="mean-expression-and-relative-expression-of-single-phylostrata-or-divergence-strata" class="section level3">
<h3>Mean Expression and Relative Expression of Single Phylostrata or Divergence Strata</h3>
<p><strong>TAI</strong> or <strong>TDI</strong> patterns are very useful to gain a first insight into the mean transcriptome age or mean sequence divergence of genes being most active during the corresponding developmental stage or experiment.</p>
<p>To further investigate the origins of the global <strong>TAI</strong> or <strong>TDI</strong> pattern it is useful to visualize the mean gene expression of each Phylostratum or Divergence-Stratum class.</p>
<div id="mean-expression-levels-of-a-phyloexpressionset-and-divergenceexpressionset" class="section level4">
<h4>Mean Expression Levels of a PhyloExpressionSet and DivergenceExpressionSet</h4>
<p>Visualizing the mean gene expression of genes corresponding to the same Phylostratum or Divergence Stratum class allows users to detect biological process specific groups of Phylostrata or Divergence Strata that are most expressed during the underlying biological process. This might lead to correlating specific groups of Phylostrata or Divergence Strata sharing similar evolutionary origins with common functions or functional contributions to a specific developmental process.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean gene expression of each Phylostratum class</span>
<span class="kw">PlotMeans</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
           <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">12</span>), 
           <span class="dt">legendName    =</span> <span class="st">&quot;PS&quot;</span>,
           <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
           <span class="dt">lty           =</span> <span class="dv">1</span>, 
           <span class="dt">cex           =</span> <span class="fl">0.7</span>, 
           <span class="dt">lwd           =</span> <span class="dv">5</span> ) </code></pre>
<p>Here we see that the mean gene expression of Phylostratum group: PS1-3 (genes evolved before the establishment of embryogenesis in plants) are more expressed during <em>A. thaliana</em> embryogenesis than PS4-12 (genes evolved during or after the establishment of embryogenesis in plants).</p>
<p>In different biological processes different Phylostratum groups or combination of groups might resemble the majority of expressed genes.</p>
<p>The <code>PlotMeans()</code> function takes an PhyloExpressionSet or DivergenceExpressionSet and visualizes for each Phylostratum the mean expression levels of all genes that correspond to this Phylostratum. The <code>Groups</code> argument takes a list storing the Phylostrata (classified into the same group) that shall be visualized on the same plot.</p>
<p>For this example we separate groups of Phylostrata into <strong>evolutionary old Phylostrata</strong> (PS1-3) in one plot versus <strong>evolutionary younger Phylostrata</strong> (PS4-12) into another plot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean gene expression of each Phylostratum class</span>
<span class="co"># in two separate plots (groups)</span>
<span class="kw">PlotMeans</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
           <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dt">group_1 =</span> <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">group_2 =</span> <span class="dv">4</span>:<span class="dv">12</span>), 
           <span class="dt">legendName    =</span> <span class="st">&quot;PS&quot;</span>,
           <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
           <span class="dt">lty           =</span> <span class="dv">1</span>, 
           <span class="dt">cex           =</span> <span class="fl">0.7</span>, 
           <span class="dt">lwd           =</span> <span class="dv">5</span> ) </code></pre>
<p>To obtain the numerical values (mean expression levels for all Phylostrata) run:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using the age.apply() function to compute the mean expression levels </span>
<span class="co"># of all Phylostrata</span>
<span class="kw">age.apply</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
           <span class="dt">FUN           =</span> colMeans ) </code></pre>
<pre><code>
     Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature
1  2607.882 2579.372 2604.856 2525.704 2554.825 2622.757 2696.331
2  2597.258 2574.745 2467.679 2388.045 2296.410 2243.716 2321.709
3  2528.272 2363.159 2019.436 2099.079 2155.642 2196.875 2855.866
4  1925.320 1887.078 1771.399 1787.175 1740.823 1867.981 2358.893
5  2378.883 2368.593 2061.729 2077.087 2076.693 2564.904 3157.761
6  1658.253 1697.242 1485.401 1462.613 1492.861 1631.741 2304.683
7  1993.321 1717.659 1480.525 1590.009 1545.078 1600.264 2385.409
8  1781.653 1670.106 1452.180 1414.052 1359.376 1816.718 2364.070
9  1758.119 1764.748 1708.815 1575.727 1388.920 1687.314 2193.930
10 2414.456 2501.390 2163.810 1938.060 1770.039 1993.032 2127.015
11 1999.163 2071.456 1702.779 1710.290 1662.099 1726.865 2501.443
12 2126.189 2036.804 1896.964 1909.578 1859.485 1995.732 2387.343
</code></pre>
<p>Here the <code>age.apply()</code> function (<code>?age.apply</code>) takes a function as argument that itself receives a <code>data.frame</code> as argument (e.g. <code>colMeans()</code>).</p>
<p>For a DivergenceExpressionSet run:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean gene expression of each Divergence Stratum class</span>
<span class="kw">PlotMeans</span>( <span class="dt">ExpressionSet =</span> DivergenceExpressionSetExample, 
           <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">10</span>), 
           <span class="dt">legendName    =</span> <span class="st">&quot;DS&quot;</span>,
           <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
           <span class="dt">lty           =</span> <span class="dv">1</span>, 
           <span class="dt">cex           =</span> <span class="fl">0.7</span>, 
           <span class="dt">lwd           =</span> <span class="dv">5</span> ) </code></pre>
<p>To obtain the numerical values (mean expression levels for all Divergence Strata) run:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using the age.apply() function to compute the mean expression levels</span>
<span class="co"># of all Divergence Strata</span>
<span class="kw">age.apply</span>( <span class="dt">ExpressionSet =</span> DivergenceExpressionSetExample, 
           <span class="dt">FUN           =</span> colMeans ) </code></pre>
<pre><code>
     Zygote Quadrant Globular    Heart  Torpedo     Bent   Mature
1  5222.189 5230.547 5254.464 4911.494 4807.936 4654.683 4277.490
2  3146.510 3020.156 2852.072 2807.367 2845.025 3002.967 3237.315
3  2356.008 2239.344 2257.539 2272.270 2360.816 2529.276 2912.164
4  2230.350 2180.706 2050.895 2049.035 2001.043 2127.165 2608.903
5  2014.600 1994.640 1884.899 1851.554 1858.913 1920.185 2210.391
6  2096.593 2018.440 1938.765 1961.828 1905.246 2005.523 2339.767
7  1836.290 1832.815 1734.319 1719.186 1659.044 1736.141 2201.981
8  1784.470 1762.151 1635.529 1624.682 1590.489 1711.439 1983.607
9  1649.254 1659.455 1522.214 1485.560 1453.689 1584.176 1767.276
10 1660.750 1735.086 1605.275 1473.854 1398.067 1438.258 1541.633
</code></pre>
</div>
<div id="relative-expression-levels-of-a-phyloexpressionset-and-divergenceexpressionset" class="section level4">
<h4>Relative Expression Levels of a PhyloExpressionSet and DivergenceExpressionSet</h4>
<p>Introduced by Domazet-Loso and Tautz, (2010), relative expression levels are defined as a linear transformation of the mean expression levels (of each Phylostratum or Divergence-Stratum) into the interval <span class="math">\([0,1]\)</span> (Quint et al., 2012 and Drost et al., 2015). This procedure allows users to compare mean expression patterns between Phylostrata or Divergence Strata independent from their actual magnitude. Hence, relative expression profiles aim to correlate the mean expression profiles of groups of Phylostrata or Divergence Strata due to the assumption that genes or groups of genes sharing a similar expression profile might be regulated by similar gene regulatory mechanisms or contribute to similar biological processes.</p>
<p>The <code>PlotRE()</code> function can be used (analogous to the <code>PlotMeans()</code> function) to visualize the relative expression levels of a given PhyloExpressionSet and DivergenceExpressionSet:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean gene expression of each Phylostratum class</span>
<span class="kw">PlotRE</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
        <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">10</span>), 
        <span class="dt">legendName    =</span> <span class="st">&quot;PS&quot;</span>,
        <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
        <span class="dt">lty           =</span> <span class="dv">1</span>, 
        <span class="dt">cex           =</span> <span class="fl">0.7</span>, 
        <span class="dt">lwd           =</span> <span class="dv">5</span> ) </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean gene expression of each Divergence Stratum class</span>
<span class="kw">PlotRE</span>( <span class="dt">ExpressionSet =</span> DivergenceExpressionSetExample, 
        <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">10</span>), 
        <span class="dt">legendName    =</span> <span class="st">&quot;DS&quot;</span>,
        <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
        <span class="dt">lty           =</span> <span class="dv">1</span>, 
        <span class="dt">cex           =</span> <span class="fl">0.7</span>, 
        <span class="dt">lwd           =</span> <span class="dv">5</span> ) </code></pre>
<p>or again by assigning Phylostratum or Divergence Stratum groups that shall be visualized in different plots:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean gene expression of each Phylostratum class</span>
<span class="kw">PlotRE</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
        <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dt">group_1 =</span> <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">group_2 =</span> <span class="dv">4</span>:<span class="dv">12</span>), 
        <span class="dt">legendName    =</span> <span class="st">&quot;PS&quot;</span>,
        <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
        <span class="dt">lty           =</span> <span class="dv">1</span>, 
        <span class="dt">cex           =</span> <span class="fl">0.7</span>, 
        <span class="dt">lwd           =</span> <span class="dv">5</span> ) </code></pre>
<p>The relative expression levels can be obtained using the <code>REMatrix()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Getting the relative expression levels for all Phylostrata</span>
<span class="kw">REMatrix</span>(PhyloExpressionSetExample) </code></pre>
<pre><code>
      Zygote  Quadrant   Globular      Heart    Torpedo       Bent    Mature
1  0.4816246 0.3145330 0.46389184 0.00000000 0.17067495 0.56880234 1.0000000
2  1.0000000 0.9363209 0.63348381 0.40823711 0.14904726 0.00000000 0.2206063
3  0.6083424 0.4109402 0.00000000 0.09521758 0.16284114 0.21213845 1.0000000
4  0.2985050 0.2366309 0.04946941 0.07499453 0.00000000 0.20573325 1.0000000
5  0.2893657 0.2799777 0.00000000 0.01401191 0.01365328 0.45908792 1.0000000
6  0.2323316 0.2786335 0.02706119 0.00000000 0.03592044 0.20084761 1.0000000
7  0.5666979 0.2620602 0.00000000 0.12099252 0.07133814 0.13232551 1.0000000
8  0.4203039 0.3092784 0.09237036 0.05442042 0.00000000 0.45520558 1.0000000
9  0.4586261 0.4668613 0.39738003 0.23205534 0.00000000 0.37067096 1.0000000
10 0.8811321 1.0000000 0.53841500 0.22974016 0.00000000 0.30490542 0.4881046
11 0.4015809 0.4877111 0.04846721 0.05741594 0.00000000 0.07716367 1.0000000
12 0.5052572 0.3359211 0.07100055 0.09489782 0.00000000 0.25811214 1.0000000
</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Getting the relative expression levels for all Divergence-Strata</span>
<span class="kw">REMatrix</span>(DivergenceExpressionSetExample) </code></pre>
<pre><code>      Zygote  Quadrant   Globular      Heart    Torpedo      Bent    Mature
1  0.9669643 0.9755188 1.00000000 0.64894653 0.54294759 0.3860827 0.0000000
2  0.7888009 0.4949178 0.10397567 0.00000000 0.08758660 0.4549387 1.0000000
3  0.1733953 0.0000000 0.02704324 0.04893726 0.18054185 0.4309208 1.0000000
4  0.3772372 0.2955661 0.08201140 0.07895260 0.00000000 0.2074848 1.0000000
5  0.4543752 0.3987496 0.09292474 0.00000000 0.02050713 0.1912595 1.0000000
6  0.4403615 0.2605017 0.07713944 0.13021586 0.00000000 0.2307754 1.0000000
7  0.3264585 0.3200581 0.13864386 0.11077270 0.00000000 0.1420009 1.0000000
8  0.4934416 0.4366671 0.11457069 0.08697865 0.00000000 0.3076689 1.0000000
9  0.6236387 0.6561674 0.21851855 0.10163374 0.00000000 0.4161087 1.0000000
10 0.7794318 1.0000000 0.61482564 0.22487531 0.00000000 0.1192539 0.4259882
</code></pre>
<p>The same could also be done using the <code>age.apply()</code> function in combination with the <code>RE()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Getting the relative expression levels for all Phylostrata</span>
<span class="kw">age.apply</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
           <span class="dt">FUN           =</span> RE ) </code></pre>
<pre><code>      Zygote  Quadrant   Globular      Heart    Torpedo       Bent    Mature
1  0.4816246 0.3145330 0.46389184 0.00000000 0.17067495 0.56880234 1.0000000
2  1.0000000 0.9363209 0.63348381 0.40823711 0.14904726 0.00000000 0.2206063
3  0.6083424 0.4109402 0.00000000 0.09521758 0.16284114 0.21213845 1.0000000
4  0.2985050 0.2366309 0.04946941 0.07499453 0.00000000 0.20573325 1.0000000
5  0.2893657 0.2799777 0.00000000 0.01401191 0.01365328 0.45908792 1.0000000
6  0.2323316 0.2786335 0.02706119 0.00000000 0.03592044 0.20084761 1.0000000
7  0.5666979 0.2620602 0.00000000 0.12099252 0.07133814 0.13232551 1.0000000
8  0.4203039 0.3092784 0.09237036 0.05442042 0.00000000 0.45520558 1.0000000
9  0.4586261 0.4668613 0.39738003 0.23205534 0.00000000 0.37067096 1.0000000
10 0.8811321 1.0000000 0.53841500 0.22974016 0.00000000 0.30490542 0.4881046
11 0.4015809 0.4877111 0.04846721 0.05741594 0.00000000 0.07716367 1.0000000
12 0.5052572 0.3359211 0.07100055 0.09489782 0.00000000 0.25811214 1.0000000
</code></pre>
<p>Quint et al. (2012) introduced an additional way of visualizing the difference of relative expression levels between groups of Phylostrata/Divergence-Strata.</p>
<p>This bar plot comparing the mean relative expression levels of one Phylostratum/Divergence-Stratum group with all other groups can be plotted analogous to the <code>PlotMeans()</code> and <code>PlotRE()</code> functions:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean relative expression of two Phylostratum groups</span>
<span class="kw">PlotBarRE</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
           <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dt">group_1 =</span> <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">group_2 =</span> <span class="dv">4</span>:<span class="dv">12</span>), 
           <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
           <span class="dt">ylab          =</span> <span class="st">&quot;Mean Relative Expression&quot;</span>, 
           <span class="dt">cex           =</span> <span class="dv">2</span>) </code></pre>
<p>Here the argument <code>Groups = list(1:3, 4:12)</code> corresponds to dividing Phylostrata 1-12 into Phylostratum groups defined as <em>origin before embryogenesis</em> (group one: PS1-3) and <em>origin during or after embryogenesis</em> (group two: PS4-12). A <a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/kruskal.test.html">Kruskal-Wallis Rank Sum Test</a> is then performed to test the statistical significance of the different bars that are compared. The ’*’ corresponds to a statistically significant difference.</p>
<p>Additionally the ratio between both values represented by the bars to be compared can be visualized as function within the bar plot using the <code>ratio = TRUE</code> argument:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean relative expression of two Phylostratum groups</span>
<span class="kw">PlotBarRE</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
           <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dt">group_1 =</span> <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">group_2 =</span> <span class="dv">4</span>:<span class="dv">12</span>), 
           <span class="dt">ratio         =</span> <span class="ot">TRUE</span>,
           <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
           <span class="dt">ylab          =</span> <span class="st">&quot;Mean Relative Expression&quot;</span>, 
           <span class="dt">cex           =</span> <span class="dv">2</span> ) </code></pre>
<p>It is also possible to compare more than two groups:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualizing the mean relative expression of three Phylostratum groups</span>
<span class="kw">PlotBarRE</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
           <span class="dt">Groups        =</span> <span class="kw">list</span>(<span class="dt">group_1 =</span> <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">group_2 =</span> <span class="dv">4</span>:<span class="dv">6</span>, <span class="dt">group_3 =</span> <span class="dv">7</span>:<span class="dv">12</span>), 
           <span class="dt">wLength       =</span> <span class="fl">0.05</span>,
           <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
           <span class="dt">ylab          =</span> <span class="st">&quot;Mean Relative Expression&quot;</span>, 
           <span class="dt">cex           =</span> <span class="dv">2</span> ) </code></pre>
<p>For the corresponding statistically significant stages, a <em>Posthoc</em> test can be performed to detect the combinations of differing bars that cause the global statistical significance.</p>
</div>
</div>
</div>
<div id="supplementary-information" class="section level1">
<h1>Supplementary Information</h1>
<p>Most visualization functions in the <em><code>myTAI</code></em> package have an <strong>ellipsis</strong> argument (<code>?dotsMethods</code>) which allows you to modify the <code>cex.lab</code>, <code>cex.axis</code>, and <code>cex</code> arguments within the plot.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cex = 0.5, cex.lab = 0.5, cex.axis = 0.5</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span>,
             <span class="dt">cex           =</span> <span class="fl">0.5</span>, 
             <span class="dt">cex.lab       =</span> <span class="fl">0.5</span>, 
             <span class="dt">cex.axis      =</span> <span class="fl">0.5</span> )</code></pre>
<p>The <code>cex</code> argument modifies the the p-value font size, the <code>cex.lab</code> argument modifies the font size of the x-axis and y-axis labels, and the <code>cex.axis</code> argument modifies the font size of the axis labels.</p>
<p>More examples:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cex = 2, cex.lab = 1, cex.axis = 0.5 </span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span>,
             <span class="dt">cex           =</span> <span class="dv">2</span>, 
             <span class="dt">cex.lab       =</span> <span class="dv">1</span>, 
             <span class="dt">cex.axis      =</span> <span class="fl">0.5</span> )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cex = 0.5, cex.lab = 0.7, cex.axis = 1.5</span>
<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span>,
             <span class="dt">cex           =</span> <span class="fl">0.5</span>, 
             <span class="dt">cex.lab       =</span> <span class="fl">0.7</span>, 
             <span class="dt">cex.axis      =</span> <span class="fl">1.5</span> )</code></pre>
<p>These arguments can analogously be used for all other plot functions, e.g. <code>PlotMeans()</code>, <code>PlotRE()</code>, etc.</p>
<div id="saving-plots-on-local-machine" class="section level3">
<h3>Saving Plots on Local Machine</h3>
<p>To save plots generated with <code>myTAI</code> on a local machine users can use the following functions implemented in the R language: <code>png</code>, <code>pdf</code>, <code>svg</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># save the TAI profile to a local machine with png()</span>
<span class="kw">png</span>(<span class="st">&quot;ExampleTAIProfile.png&quot;</span>, <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">600</span>)

<span class="kw">PlotPattern</span>( <span class="dt">ExpressionSet =</span> PhyloExpressionSetExample, 
             <span class="dt">type          =</span> <span class="st">&quot;l&quot;</span>, 
             <span class="dt">lwd           =</span> <span class="dv">6</span>, 
             <span class="dt">xlab          =</span> <span class="st">&quot;Ontogeny&quot;</span>, 
             <span class="dt">ylab          =</span> <span class="st">&quot;TAI&quot;</span>,
             <span class="dt">cex           =</span> <span class="dv">1</span>, 
             <span class="dt">cex.lab       =</span> <span class="dv">1</span>, 
             <span class="dt">cex.axis      =</span> <span class="fl">1.2</span> )

<span class="kw">dev.off</span>()</code></pre>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Domazet-Loso T. and Tautz D. <strong>A phylogenetically based transcriptome age index mirrors ontogenetic divergence patterns</strong>. <em>Nature</em> (2010) 468: 815-8.</p>
<p>Quint M. et al. <strong>A transcriptomic hourglass in plant embryogenesis</strong>. <em>Nature</em> (2012) 490: 98-101.</p>
<p>Drost HG, Gabel A, Grosse I, Quint M. <strong>Evidence for Active Maintenance of Phylotranscriptomic Hourglass Patterns in Animal and Plant Embryogenesis</strong>. <em>Mol. Biol. Evol.</em> (2015) 32 (5): 1221-1231.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
